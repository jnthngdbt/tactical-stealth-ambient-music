import{c as x,e as z,d as E,A as P,H as W,x as C,W as K,n as j,y as b,i as k,z as y,h as v,V as R,o as D}from"./three.module-B8BHS4ps.js";import{P as H}from"./PointerLockControls-CJpi_4Po.js";import{E as A,R as G}from"./RenderPass-DY6MlMTT.js";document.body.style.margin="0";document.body.style.overflow="hidden";const N="https://raw.githubusercontent.com/jnthngdbt/tactical-steath-ambient-music-assets/refs/heads/main/",a=new x;a.background=new z(327697);const d=new E(75,window.innerWidth/window.innerHeight,.1,1e3);d.position.set(0,2,0);a.add(d);const B=new P(1249570);a.add(B);const L=new W(7799039,.5);L.position.set(-50,10,-10);a.add(L);const M=[];for(let e=0;e<10;e++){const o=new C(16733440,10,0,1.6);o.position.set((Math.random()-.5)*100,Math.random()*-10-5,Math.random()*-30-10),a.add(o),M.push(o)}const c=new K({antialias:!0});c.setSize(window.innerWidth,window.innerHeight);document.body.appendChild(c.domElement);const I=new j,s=I.load(N+"textures/noise-perlin-0.png");s.wrapS=b;s.wrapT=b;s.repeat.set(40,40);const p=new k(20,5,100,100),O=new y({color:13421772,bumpMap:s,bumpScale:.7}),h=p.attributes.position;for(let e=0;e<h.count;e++){const o=Math.random()*.05;h.setZ(e,o)}h.needsUpdate=!0;p.computeVertexNormals();const w=new v(p,O);w.rotation.x=-Math.PI/2;w.position.z=-2;w.receiveShadow=!0;a.add(w);s.repeat.set(.5,.3);const U=new k(300,100,500,500),V=new y({color:13421772,displacementMap:s,displacementScale:50,bumpMap:s,bumpScale:50}),l=new v(U,V);l.rotation.x=-Math.PI/4;l.position.z=-80;l.position.y=-20;l.receiveShadow=!0;a.add(l);const r=new H(d,c.domElement);document.addEventListener("click",()=>{r.lock()});r.addEventListener("lock",()=>{console.log("Pointer locked")});r.addEventListener("unlock",()=>{console.log("Pointer unlocked")});const n={forward:!1,backward:!1,left:!1,right:!1};document.addEventListener("keydown",e=>{switch(e.code){case"KeyW":n.forward=!0;break;case"KeyS":n.backward=!0;break;case"KeyA":n.left=!0;break;case"KeyD":n.right=!0;break}});document.addEventListener("keyup",e=>{switch(e.code){case"KeyW":n.forward=!1;break;case"KeyS":n.backward=!1;break;case"KeyA":n.left=!1;break;case"KeyD":n.right=!1;break}});const u=new A(c),F=new G(a,d);u.addPass(F);const J=()=>{M.forEach(e=>{e.intensity=.5+Math.random()*2.5})},T=new D,t=new R,m=20;function S(){requestAnimationFrame(S),J();const e=T.getDelta();if(r.isLocked){t.x-=t.x*15*e,t.z-=t.z*10*e,n.forward&&(t.z-=m*e),n.backward&&(t.z+=m*e),n.left&&(t.x-=m*e),n.right&&(t.x+=m*e);const o=.1,i=Math.abs(t.x)>o&&Math.abs(t.z)>o?.707:1;r.moveRight(t.x*i*e),r.moveForward(-t.z*i*e)}u.render(e)}S();window.addEventListener("resize",()=>{d.aspect=window.innerWidth/window.innerHeight,d.updateProjectionMatrix(),c.setSize(window.innerWidth,window.innerHeight),u.setSize(window.innerWidth,window.innerHeight)});var g;(g=document.getElementById("downloadBtn"))==null||g.addEventListener("click",q);function q(){a.updateMatrixWorld();var e=a.toJSON(),o=JSON.stringify(e);const f=new Blob([o],{type:"application/json"}),i=document.createElement("a");i.href=URL.createObjectURL(f),i.download="tsam.three.js.scene.json",document.body.appendChild(i),i.click(),document.body.removeChild(i)}
